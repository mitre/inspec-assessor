<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Profile Inheritance and Overlays | MITRE InSpec Assessor Course</title>
    <meta name="generator" content="VuePress 1.9.7">
    
    <meta name="description" content="The MITRE InSpec Team&#39;s Assessor course for InSpec Profiles">
    
    <link rel="preload" href="/inspec-assessor/assets/css/0.styles.0213b11c.css" as="style"><link rel="preload" href="/inspec-assessor/assets/js/app.fe1f93d1.js" as="script"><link rel="preload" href="/inspec-assessor/assets/js/2.2738782e.js" as="script"><link rel="preload" href="/inspec-assessor/assets/js/18.e0c2e0fd.js" as="script"><link rel="prefetch" href="/inspec-assessor/assets/js/10.546059c9.js"><link rel="prefetch" href="/inspec-assessor/assets/js/11.05c5934c.js"><link rel="prefetch" href="/inspec-assessor/assets/js/12.588a52e2.js"><link rel="prefetch" href="/inspec-assessor/assets/js/13.70c15bee.js"><link rel="prefetch" href="/inspec-assessor/assets/js/14.e328e7e1.js"><link rel="prefetch" href="/inspec-assessor/assets/js/15.40fd7af1.js"><link rel="prefetch" href="/inspec-assessor/assets/js/16.97b76089.js"><link rel="prefetch" href="/inspec-assessor/assets/js/17.52a7f01e.js"><link rel="prefetch" href="/inspec-assessor/assets/js/19.d31e7af7.js"><link rel="prefetch" href="/inspec-assessor/assets/js/20.5586992e.js"><link rel="prefetch" href="/inspec-assessor/assets/js/21.5cbad01f.js"><link rel="prefetch" href="/inspec-assessor/assets/js/22.a8df269d.js"><link rel="prefetch" href="/inspec-assessor/assets/js/23.95aa6bc2.js"><link rel="prefetch" href="/inspec-assessor/assets/js/24.d4cc2416.js"><link rel="prefetch" href="/inspec-assessor/assets/js/25.c26e7023.js"><link rel="prefetch" href="/inspec-assessor/assets/js/26.f804be0d.js"><link rel="prefetch" href="/inspec-assessor/assets/js/27.ceea8084.js"><link rel="prefetch" href="/inspec-assessor/assets/js/28.4805dbea.js"><link rel="prefetch" href="/inspec-assessor/assets/js/3.7ab87a97.js"><link rel="prefetch" href="/inspec-assessor/assets/js/4.a0a13830.js"><link rel="prefetch" href="/inspec-assessor/assets/js/5.64a9703e.js"><link rel="prefetch" href="/inspec-assessor/assets/js/6.af8f00ad.js"><link rel="prefetch" href="/inspec-assessor/assets/js/7.b17b3b65.js"><link rel="prefetch" href="/inspec-assessor/assets/js/8.bb905c73.js"><link rel="prefetch" href="/inspec-assessor/assets/js/9.bcb1e7d7.js">
    <link rel="stylesheet" href="/inspec-assessor/assets/css/0.styles.0213b11c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/inspec-assessor/" class="home-link router-link-active"><!----> <span class="site-name">MITRE InSpec Assessor Course</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/inspec-assessor/course/1.html" class="nav-link">
  Course
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/LinuxInstall.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/MacInstall.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/WindowsInstall.html" class="nav-link">
  Windows
</a></li></ul></div></div><div class="nav-item"><a href="/inspec-assessor/contact.html" class="nav-link">
  Contact
</a></div> <a href="https://github.com/mitre/inspec-assessor" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/inspec-assessor/course/1.html" class="nav-link">
  Course
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Install" class="dropdown-title"><span class="title">Install</span> <span class="arrow down"></span></button> <button type="button" aria-label="Install" class="mobile-dropdown-title"><span class="title">Install</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/LinuxInstall.html" class="nav-link">
  Linux
</a></li><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/MacInstall.html" class="nav-link">
  Mac
</a></li><li class="dropdown-item"><!----> <a href="/inspec-assessor/installation/WindowsInstall.html" class="nav-link">
  Windows
</a></li></ul></div></div><div class="nav-item"><a href="/inspec-assessor/contact.html" class="nav-link">
  Contact
</a></div> <a href="https://github.com/mitre/inspec-assessor" target="_blank" rel="noopener noreferrer" class="repo-link">
    Contribute!
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><a href="/inspec-assessor/course/1.html" class="sidebar-link">1. About InSpec</a></li><li><a href="/inspec-assessor/course/2.html" class="sidebar-link">2. Course overview</a></li><li><a href="/inspec-assessor/course/3.html" class="sidebar-link">3. Command line overview</a></li><li><a href="/inspec-assessor/course/4.html" class="sidebar-link">4. Identify your stack of components for the system you are assessing (i.e., Cloud Services, Virtualization Platforms, Operating Systems, Databases, Application Logic, and Web Servers)</a></li><li><a href="/inspec-assessor/course/5.html" class="sidebar-link">5. Review the READMEs for each profile for specific run instructions</a></li><li><a href="/inspec-assessor/course/6.html" class="sidebar-link">6. Understanding many ways of installing/staging InSpec, depending on your assessment restrictions</a></li><li><a href="/inspec-assessor/course/7.html" class="sidebar-link">7. Example running an InSpec profile directly from Github</a></li><li><a href="/inspec-assessor/course/8.html" class="sidebar-link">8. Using an --input-file to tailor specifics</a></li><li><a href="/inspec-assessor/course/9.html" class="sidebar-link">9. MITRE Heimdall Tools</a></li><li><a href="/inspec-assessor/course/10.html" class="sidebar-link">10. Advanced - running InSpec against</a></li><li><a href="/inspec-assessor/course/11.html" class="sidebar-link">11. Understand a control's structure</a></li><li><a href="/inspec-assessor/course/12.html" aria-current="page" class="active sidebar-link">Profile Inheritance and Overlays</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#profile-inheritance-and-overlays" class="sidebar-link">Profile Inheritance and Overlays</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#defining-the-profile-dependency" class="sidebar-link">Defining the Profile Dependency</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#including-all-controls-from-a-profile" class="sidebar-link">Including All Controls from a Profile</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#skipping-a-control-from-a-profile" class="sidebar-link">Skipping a Control From a Profile</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#modifying-a-control" class="sidebar-link">Modifying a Control</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#selectively-including-controls-from-a-profile" class="sidebar-link">Selectively Including Controls From a Profile</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#additional-examples" class="sidebar-link">Additional Examples</a></li><li class="sidebar-sub-header"><a href="/inspec-assessor/course/12.html#exercise" class="sidebar-link">Exercise</a></li></ul></li></ul></li><li><a href="/inspec-assessor/course/13.html" class="sidebar-link">13. Example running an InSpec profile using a local archive (for air-gapped target systems)</a></li><li><a href="/inspec-assessor/course/14.html" class="sidebar-link">14. Additional Resources</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h2 id="profile-inheritance-and-overlays"><a href="#profile-inheritance-and-overlays" class="header-anchor">#</a> Profile Inheritance and Overlays</h2> <p>In addition to its own controls, an InSpec profile can bring in the controls from another InSpec profile. Additionally, when inheriting the controls of another profile, a profile can skip or even modify those included controls.</p> <p>When a profile includes controls from another profile, it is usually referred to as a “meta profile” or a “profile overlay.” Those of us with Chef background sometimes call it a “wrapper profile”.</p> <p>::: info Further information on inheritance
You can find out more about inhertiance here <a href="https://www.inspec.io/docs/reference/profiles/#sts=Profile%20Dependencies" target="_blank" rel="noopener noreferrer">https://www.inspec.io/docs/reference/profiles/#sts=Profile%20Dependencies<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>
:::</p> <h3 id="defining-the-profile-dependency"><a href="#defining-the-profile-dependency" class="header-anchor">#</a> Defining the Profile Dependency</h3> <p>Before a profile (e.g. <code>Profile A</code>) can use controls from another profile (e.g. <code>Profile B</code>), <code>Profile B</code> needs to be included in <code>Profile A</code>'s <code>inspec.yml</code> file in the <code>depends</code> section. Each profile that <code>Profile A</code> depends on should list its name and location. For example:</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token key atrule">depends</span><span class="token punctuation">:</span>
 <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> linux<span class="token punctuation">-</span>baseline
   <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/dev<span class="token punctuation">-</span>sec/linux<span class="token punctuation">-</span>baseline/archive/master.tar.gz
 <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> ssh<span class="token punctuation">-</span>baseline
   <span class="token key atrule">url</span><span class="token punctuation">:</span> https<span class="token punctuation">:</span>//github.com/dev<span class="token punctuation">-</span>sec/ssh<span class="token punctuation">-</span>baseline/archive/master.tar.gz
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>Once defined in the <code>inspec.yml</code> file, controls from the included profiles can be used!</p> <h3 id="including-all-controls-from-a-profile"><a href="#including-all-controls-from-a-profile" class="header-anchor">#</a> Including All Controls from a Profile</h3> <p>With the <code>include_controls</code> command in a profile, all controls from the named profile will be executed every time the including profile is executed. Below you can see an example of a profile and overlay.</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx profile</span>
control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
<span class="token keyword">end</span>

include_controls <span class="token command-literal"><span class="token command string">`my_nginx_overlay`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx_overlay</span>
control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>In the example above, every time <code>my_nginx</code> profile is executed, all the controls from <code>my_nginx_overlay</code> are also executed. Therefore, the following controls would be executed:</p> <ul><li>nginx-version</li> <li>nginx-modules</li> <li>nginx-conf</li> <li>first-overlay-control</li> <li>second-overlay-control</li></ul> <h3 id="skipping-a-control-from-a-profile"><a href="#skipping-a-control-from-a-profile" class="header-anchor">#</a> Skipping a Control From a Profile</h3> <p>What if one of the controls from the included profile does not apply to your environment? Luckily, it is not necessary to maintain a slightly-modified copy of the included profile just to delete a control. The skip_control command tells InSpec to not run a particular control.</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx profile</span>
control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
<span class="token keyword">end</span>

include_controls <span class="token command-literal"><span class="token command string">`my_nginx_overlay`</span></span> <span class="token keyword">do</span>
  skip_control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx_overlay</span>
control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>In the above example, all controls from <code>my_nginx</code> profile and <code>my_nginx_overlay</code> profile will be executed every time my-app-profile is executed <strong>except</strong> for control <code>second-overlay-control</code> from the <code>my_nginx_overlay</code> profile.</p> <h3 id="modifying-a-control"><a href="#modifying-a-control" class="header-anchor">#</a> Modifying a Control</h3> <p>Let’s say a particular control from an included profile should still run, but the impact isn’t appropriate? Perhaps the test should still run, but if it fails it should be treated as low severity instead of high severity?</p> <p>When a control is included, it can also be modified!</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx profile</span>
control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
<span class="token keyword">end</span>

include_controls <span class="token command-literal"><span class="token command string">`my_nginx_overlay`</span></span> <span class="token keyword">do</span>
  control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span> <span class="token keyword">do</span>
    impact <span class="token number">0.5</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx_overlay</span>
control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
<span class="token keyword">end</span>
control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>In the above example, all controls from <code>my_nginx</code> profile are executed along with all the controls from the including profile, <code>my_nginx_overlay</code>. However, should control <code>second-overlay-control</code> fail, it will be raised with an impact of <code>0.5</code> instead of the originally-intended impact of <code>1.0</code>.</p> <h3 id="selectively-including-controls-from-a-profile"><a href="#selectively-including-controls-from-a-profile" class="header-anchor">#</a> Selectively Including Controls From a Profile</h3> <p>If there are only a handful of controls that should be executed from an included profile, it’s not necessary to skip all the unneeded controls, or worse, copy/paste those controls bit-for-bit into your profile. Instead, use the <code>require_controls</code> command.</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx profile  </span>
control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
<span class="token keyword">end</span>

require_controls <span class="token command-literal"><span class="token command string">`my_nginx_overlay`</span></span> <span class="token keyword">do</span>
  control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span>
  control <span class="token command-literal"><span class="token command string">`third-overlay-control`</span></span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx_overlay</span>
control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`third-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`fourth-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`fifth-overlay-control`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>Whenever <code>my_nginx</code> is executed, in addition to its own controls, it will run only the controls specified in the <code>require_controls</code> block. In the case, the following controls would be executed:</p> <ul><li>nginx-version</li> <li>nginx-modules</li> <li>nginx-conf</li> <li>first-overlay-control</li> <li>third-overlay-control</li></ul> <p>Controls <code>second-overlay-control</code>, <code>fourth-overlay-control</code>, and <code>fifth-overlay-control</code> would not be run, just as if they were manually skipped. This method of including specific controls ensures only the controls specified are executed; if new controls are added to a later version of <code>my_nginx_overlay</code>, they would not be run.</p> <p>And, just the way its possible to modify controls when using <code>include_controls</code>, controls can be modified as well.</p> <div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx profile  </span>
control <span class="token string-literal"><span class="token string">'nginx-version'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX version'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required version of NGINX should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-modules'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX modules'</span></span>
  desc <span class="token string-literal"><span class="token string">'The required NGINX modules should be installed.'</span></span>
<span class="token keyword">end</span>

control <span class="token string-literal"><span class="token string">'nginx-conf'</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
  title <span class="token string-literal"><span class="token string">'NGINX configuration'</span></span>
  desc <span class="token string-literal"><span class="token string">'The NGINX config file should owned by root, be writable only by owner, and not writeable or and readable by others.'</span></span>
<span class="token keyword">end</span>

require_controls <span class="token command-literal"><span class="token command string">`my_nginx_overlay`</span></span> <span class="token keyword">do</span>
  control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span> <span class="token keyword">do</span>
    impact <span class="token number">0.5</span>
  <span class="token keyword">end</span>
  control <span class="token command-literal"><span class="token command string">`third-overlay-control`</span></span>
<span class="token keyword">end</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><div class="language-ruby line-numbers-mode"><pre class="language-ruby"><code><span class="token comment"># my_nginx_overlay</span>
control <span class="token command-literal"><span class="token command string">`first-overlay-control`</span></span> <span class="token keyword">do</span>
  impact <span class="token number">1.0</span>
<span class="token keyword">end</span>

control <span class="token command-literal"><span class="token command string">`second-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`third-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`fourth-overlay-control`</span></span>
control <span class="token command-literal"><span class="token command string">`fifth-overlay-control`</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>As with the prior example, only <code>first-overlay-control</code> and <code>third-overlay-control</code> are executed, but if <code>first-overlay-control</code> fails, it will report with an impact of <code>0.5</code> instead of the originally-intended <code>1.0</code> impact.</p> <h3 id="additional-examples"><a href="#additional-examples" class="header-anchor">#</a> Additional Examples</h3> <ul><li><a href="https://github.com/mitre/helloworld-web-baseline" target="_blank" rel="noopener noreferrer">https://github.com/mitre/helloworld-web-baseline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/chris-rock/acme-inspec-profile" target="_blank" rel="noopener noreferrer">https://github.com/chris-rock/acme-inspec-profile<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://github.com/mitre/aws-rds-crunchy-data-postgresql-9-stig-baseline" target="_blank" rel="noopener noreferrer">https://github.com/mitre/aws-rds-crunchy-data-postgresql-9-stig-baseline<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul> <h3 id="exercise"><a href="#exercise" class="header-anchor">#</a> Exercise</h3> <p>Create your own overlay profile for nginx and use 5 controls that you would want to modify.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/mitre/inspec-assessor/edit/main/docs/course/12.md" target="_blank" rel="noopener noreferrer">Help us improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/inspec-assessor/course/11.html" class="prev">
        11. Understand a control's structure
      </a></span> <span class="next"><a href="/inspec-assessor/course/13.html">
        13. Example running an InSpec profile using a local archive (for air-gapped target systems)
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/inspec-assessor/assets/js/app.fe1f93d1.js" defer></script><script src="/inspec-assessor/assets/js/2.2738782e.js" defer></script><script src="/inspec-assessor/assets/js/18.e0c2e0fd.js" defer></script>
  </body>
</html>
